<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>اتزان - لوحة التحكم</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    body {
      background: linear-gradient(135deg, #f9fdfd 0%, #e6faff 50%, #f0fcfb 100%);
      -webkit-font-smoothing: antialiased;
      font-family: 'Cairo', sans-serif;
      overflow-x: hidden;
    }

    header {
      background: linear-gradient(135deg, #168dfa 0%, #5DAAB7 100%);
      animation: fadeDown 0.6s ease;
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -10%;
      width: 200px;
      height: 200px;
      background: radial-gradient(circle, rgba(255,255,255,0.1), transparent);
      border-radius: 50%;
      animation: float 6s ease-in-out infinite;
    }

    header::after {
      content: '';
      position: absolute;
      bottom: -30%;
      left: -5%;
      width: 150px;
      height: 150px;
      background: radial-gradient(circle, rgba(255,255,255,0.08), transparent);
      border-radius: 50%;
      animation: float 8s ease-in-out infinite reverse;
    }

    @keyframes fadeDown {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-15px); }
    }

    .device { 
      width: 100%; 
      max-width: 420px; 
      min-height: 844px; 
      margin: 20px auto; 
    }

    .progress-track { 
      background: rgba(255,255,255,0.35); 
      height: 12px; 
      border-radius: 999px; 
      overflow: hidden; 
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
    }

    .progress-bar { 
      height: 12px; 
      border-radius: 999px; 
      width: 0%; 
      transition: width 0.8s cubic-bezier(0.65, 0, 0.35, 1); 
      box-shadow: 0 2px 8px rgba(255,255,255,0.4);
    }

    .card-shadow {
      box-shadow: 0 8px 20px rgba(0,0,0,0.06);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .card-shadow::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .card-shadow:hover {
      transform: translateY(-4px);
      box-shadow: 0 16px 32px rgba(0,0,0,0.12);
    }

    .card-shadow:hover::before {
      opacity: 1;
    }

    .fade-in { 
      animation: fadeInUp 0.5s ease; 
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(15px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .popup-overlay {
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%;
      background: rgba(0,0,0,0.5); 
      display: none;
      align-items: center; 
      justify-content: center; 
      z-index: 100;
      backdrop-filter: blur(8px);
    }

    .popup-box {
      background: white; 
      padding: 28px; 
      border-radius: 20px;
      max-width: 340px; 
      width: 90%; 
      text-align: center;
      transform: scale(0.8); 
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 20px 60px rgba(0,0,0,0.2);
      border: 3px solid rgba(22,141,250,0.15);
    }

    .popup-box.show { 
      transform: scale(1); 
      opacity: 1; 
    }

    #motivate { 
      animation: pulse 2s ease-in-out infinite alternate; 
      position: relative;
      overflow: hidden;
    }

    #motivate::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    #motivate:active::before {
      width: 400px;
      height: 400px;
    }

    @keyframes pulse {
      from { transform: scale(1); opacity: 1; }
      to { transform: scale(1.02); opacity: 0.95; }
    }

    nav a {
      transition: all 0.3s ease;
    }

    nav a:hover svg {
      transform: scale(1.15);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    nav a:hover {
      color: #168dfa;
    }

    nav {
      transform: translateY(100%);
      animation: slideUp 0.6s ease-out forwards;
      animation-delay: 0.3s;
    }

    @keyframes slideUp {
      to {
        transform: translateY(0);
      }
    }

    .nav-item.active { 
      color: #168dfa; 
    }

    .logo-container { /* هذا الكلاس الجديد للحاوية */
      filter: drop-shadow(0 4px 12px rgba(0,0,0,0.15));
      transition: transform 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 90px; /* حجم الحاوية */
      height: 85px; /* حجم الحاوية */
      background-color: white; /* خلفية بيضاء دائرية */
      border-radius: 99px; /* لجعلها دائرية بالكامل */
      flex-shrink: 0; /* لمنعها من التقلص */
      box-shadow: 0 0 0 4px rgba(255,255,255,0.4); /* إطار أبيض حول الدائرة */
    }

    .logo-container:hover {
      transform: scale(1.05);
    }

    .logo-header { /* اللوجو نفسه داخل الحاوية */
      height: 90%; /* يجعل اللوجو يملأ 70% من حجم الحاوية */
      width: auto;
    }


    .gradient-card {
      background: linear-gradient(135deg, var(--tw-gradient-from), var(--tw-gradient-to));
      position: relative;
      overflow: hidden;
    }

    .gradient-card::after {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1), transparent 50%);
      animation: rotate 10s linear infinite;
    }

    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .welcome-text {
      text-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    button {
      position: relative;
      overflow: hidden;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(22,141,250,0.3);
    }

    button:active {
      transform: translateY(0);
    }

    .schedule-item {
      transition: all 0.3s ease;
    }

    .schedule-item:hover {
      transform: translateX(-4px);
      background: rgba(22,141,250,0.05);
    }

    .decision-card {
      background: linear-gradient(135deg, #168dfa 0%, #5DAAB7 100%);
      position: relative;
      overflow: hidden;
    }

    .decision-card::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.15), transparent 70%);
      animation: rotate 15s linear infinite;
    }

    .icon-pulse {
      animation: iconPulse 2s ease-in-out infinite;
    }

    @keyframes iconPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
  </style>
</head>

<body class="p-4">
  <div class="device fade-in">
    <div class="w-full mx-auto bg-white rounded-3xl overflow-hidden shadow-2xl">

      <header class="p-6 text-white shadow-xl rounded-b-3xl relative z-10">
        <div class="flex items-center justify-between relative z-10">
          <div class="logo-container">
            <img src="assets/logo.webp" alt="شعار اتزان" class="logo-header">
          </div>
          <div class="text-right">
            <div class="text-xl font-bold welcome-text">أهلاً بك</div>
            <span id="adhdResult" class="text-sm opacity-95 block mt-1"></span>
          </div>
        </div>
      </header>

      <main class="p-6 space-y-6">
        <h2 class="text-right font-bold text-2xl text-gray-800 mb-4">التقدم اليومي</h2>

        <div class="grid grid-cols-2 gap-4">
          <div class="rounded-2xl p-5 card-shadow gradient-card bg-gradient-to-br from-[#10b981] to-[#a7f3d0]">
            <div class="text-white relative z-10">
              <div id="tasksPercent" class="text-2xl font-bold mb-1">0%</div>
              <div class="text-sm opacity-90">المهام اليومية</div>
            </div>
            <div class="mt-3 progress-track relative z-10">
              <div id="tasksBar" class="progress-bar bg-white"></div>
            </div>
          </div>
          <div class="rounded-2xl p-5 card-shadow gradient-card bg-gradient-to-br from-[#8b5cf6] to-[#c4b5fd]">
              <div class="text-white relative z-10">
                <div id="challengesPercent" class="text-2xl font-bold mb-1">0%</div>
                <div class="text-sm opacity-90">القرارات</div>
              </div>
              <div class="mt-3 progress-track relative z-10">
                <div id="challengesBar" class="progress-bar bg-white"></div>
              </div>
          </div>
        </div>

        <div class="space-y-4">
          <button onclick="window.location.href='schedule.html'" 
                  class="w-full rounded-2xl p-5 h-16 bg-[#168dfa] text-white text-lg font-bold card-shadow transition transform active:scale-95">
            اضبط جدولك
          </button>
          <button id="motivate" 
                  class="w-full rounded-2xl p-5 h-16 bg-gradient-to-r from-[#168dfa] to-[#5DAAB7] text-white text-lg font-bold card-shadow transition transform active:scale-95">
            حفزني
          </button>
        </div>

        <div class="rounded-2xl p-5 bg-white card-shadow">
          <div class="flex items-center justify-between mb-4">
            <div class="text-xl font-bold text-gray-800">جدول اليوم</div>
            <a href="schedule.html" class="text-gray-400 transition transform active:scale-90 hover:text-[#168dfa]">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m3 4h-14a2 2 0 00-2 2v8a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2z"/>
              </svg>
            </a>
          </div>
          <div id="schedulePreview" class="space-y-3 text-sm text-gray-500">
            <p class="text-center p-4">تحميل المهام...</p>
          </div>
        </div>

        <div onclick="window.location.href='decis1.html'" 
             class="rounded-2xl p-6 decision-card text-white flex items-center justify-between card-shadow transition transform hover:scale-105 active:scale-100 cursor-pointer">
          <div class="text-right relative z-10">
            <div class="font-bold text-xl mb-1">اتخذ قرار!</div>
            <div class="text-sm opacity-95">متردد في قرار؟ دعنا نساعدك</div>
          </div>
          <div class="w-20 h-20 bg-white/20 rounded-full flex items-center justify-center icon-pulse relative z-10">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10" fill="none" viewBox="0 0 24 24" stroke="white">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l4-4 4 4M8 15l4 4 4-4"/>
            </svg>
          </div>
        </div>

      </main>

      <nav class="sticky bottom-4 mx-4 mb-4 bg-white/90 backdrop-blur-md border-2 border-gray-100 shadow-2xl rounded-2xl z-50">
        <div class="flex justify-around py-3">
          <a href="home.html" class="flex flex-col items-center text-[#168dfa] nav-item active">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 9.75L12 4l9 5.75V20a2 2 0 01-2 2H5a2 2 0 01-2-2V9.75z" />
            </svg>
            <span class="text-xs font-semibold">الرئيسية</span>
          </a>
          <a href="decis1.html" class="flex flex-col items-center text-gray-500 hover:text-[#168dfa] nav-item">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M8 9l4-4 4 4m-8 6l4 4 4-4" />
            </svg>
            <span class="text-xs">اتخذ قرار</span>
          </a>
          <a href="pomodoro.html" class="flex flex-col items-center text-gray-500 hover:text-[#168dfa] nav-item">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <span class="text-xs">بومودورو</span>
          </a>
          <a href="schedule.html" class="flex flex-col items-center text-gray-500 hover:text-[#168dfa] nav-item">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3M4 11h16M4 19h16M5 7h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V9a2 2 0 012-2z" />
            </svg>
            <span class="text-xs">الجدول</span>
          </a>
          <a href="results.html" class="flex flex-col items-center text-gray-500 hover:text-[#168dfa] nav-item">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <span class="text-xs">النتيجة</span>
          </a>
        </div>
      </nav>
    </div>
  </div>

  <div id="popup" class="popup-overlay">
    <div class="popup-box">
      <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-[#168dfa] to-[#5DAAB7] rounded-full flex items-center justify-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
        </svg>
      </div>
      <p id="quoteText" class="mb-6 text-gray-700 text-lg leading-relaxed font-medium"></p>
      <button onclick="closePopup()" class="px-8 py-3 bg-gradient-to-r from-[#168dfa] to-[#5DAAB7] text-white rounded-xl font-bold hover:shadow-lg transition transform hover:scale-105">
        إغلاق
      </button>
    </div>
  </div>

  <script>
    const quotes = [
      "خذ الأمور خطوة بخطوة، ليس عليك إنجاز كل شيء دفعة واحدة.",
      "التنظيم يساعدك على السيطرة، ولو بخطوات صغيرة.",
      "الراحة جزء من الإنتاجية، لا تنس أن تعطي نفسك وقتًا.",
      "أنت قادر على الإنجاز، فقط قسم المهام واجعلها أبسط.",
      "كل خطوة صغيرة تقربك من هدفك الكبير.",
      "النجاح ليس في السرعة، بل في الاستمرارية والثبات."
    ];

    const popup = document.getElementById("popup");
    const quoteText = document.getElementById("quoteText");

    document.getElementById("motivate").addEventListener("click", ()=>{
      const q = quotes[Math.floor(Math.random()*quotes.length)];
      quoteText.textContent = q;
      popup.style.display = "flex";
      setTimeout(()=> document.querySelector(".popup-box").classList.add("show"), 50);
    });

    function closePopup(){
      document.querySelector(".popup-box").classList.remove("show");
      setTimeout(()=> popup.style.display="none", 300);
    }

    popup.addEventListener('click', (e) => {
        if(e.target === popup) {
            closePopup();
        }
    });

    // Function to render schedule preview
    function renderSchedulePreview() {
      const LS_KEY = "dailySchedule_v2";
      const today = new Date().toISOString().slice(0,10);
      const preview = document.getElementById("schedulePreview");
      const percentEl = document.getElementById("tasksPercent");
      const barEl = document.getElementById("tasksBar");

      const raw = localStorage.getItem(LS_KEY);
      if(!raw){ 
          preview.innerHTML = "<p class='text-center p-4 text-gray-400'>لا توجد مهام حتى الآن</p>"; 
          percentEl.textContent="0%"; 
          barEl.style.width = "0%";
          return; 
      }

      const parsed = JSON.parse(raw);
      if(parsed.date !== today || !parsed.items || parsed.items.length===0){
        preview.innerHTML = "<p class='text-center p-4 text-gray-400'>لا توجد مهام حتى الآن</p>"; 
        percentEl.textContent="0%"; 
        barEl.style.width = "0%";
        return;
      }

      const tasks = parsed.items.sort((a,b)=>a.time.localeCompare(b.time)).slice(0,3);
      preview.innerHTML = tasks.map(it=>
        `<div class='schedule-item flex items-center justify-between p-4 rounded-xl ${it.done ? 'bg-green-50' : 'bg-gray-50'} transition'>
          <div class='text-right flex-1'>
            <div class='font-semibold text-base text-gray-800 ${it.done ? 'line-through' : ''}'>${it.title}</div>
            <div class='text-sm text-gray-500 mt-1'>${it.time}</div>
          </div>
          <div class='w-6 h-6 rounded-full ${it.done ? 'bg-green-400' : 'border-2 border-gray-300'} flex items-center justify-center text-white text-sm font-bold'>
            ${it.done ? '✓' : ''}
          </div>
        </div>`
      ).join("");

      const total = parsed.items.length;
      const done = parsed.items.filter(it=>it.done).length;
      const percent = total ? Math.round((done/total)*100) : 0;

      percentEl.textContent = percent + "%";
      setTimeout(() => {
        barEl.style.width = percent + "%";
      }, 100);
    }

    // Function to render challenges progress
    function renderChallengesProgress() {
      const maxChallenges = 5;
      const taken = parseInt(localStorage.getItem("takenCount")||"0");
      let percent = Math.min(100, Math.round((taken / maxChallenges) * 100));

      document.getElementById("challengesPercent").textContent = percent + "%";
      setTimeout(() => {
        document.getElementById("challengesBar").style.width = percent + "%";
      }, 100);
    }
    
    // Function to show ADHD result
    function showADHDResult() {
        const whoResult = localStorage.getItem("whoResult");
        const resultEl = document.getElementById("adhdResult");
        if (whoResult) {
            resultEl.textContent = "نتيجة اختبار ADHD: " + whoResult;
        } else {
            resultEl.textContent = "لم تقم باختبار ADHD بعد";
        }
    }

    // Initial render on page load
    document.addEventListener('DOMContentLoaded', () => {
        renderSchedulePreview();
        renderChallengesProgress();
        showADHDResult();
    });

    // Re-render when returning to the page
    window.addEventListener('focus', () => {
        renderSchedulePreview();
        renderChallengesProgress();
    });

  </script>
</body>
</html>
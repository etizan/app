<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>لوحة التحكم</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    html, body {
      height: 100%;
      margin: 0;
      overflow: hidden;
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(to bottom right, #f9fdfd, #e6faff, #f0fcfb);
    }

    /* الحاوية الأساسية */
    .device {
      width: 100%;
      height: 100vh;
      max-width: 420px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      background: linear-gradient(to bottom right, #f9fdfd, #e6faff, #f0fcfb);
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }

    /* الهيدر */
    header {
      background: linear-gradient(90deg, #168dfa, #0f8073);
      color: white;
      border-radius: 0 0 18px 18px;
      padding: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      flex-shrink: 0;
    }

    /* المحتوى الرئيسي */
    main {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
    }

    /* البطاقات والأزرار */
    .card {
      background: #f8fffe;
      box-shadow: inset 4px 4px 8px rgba(0,0,0,0.03),
                  inset -4px -4px 8px rgba(255,255,255,0.8),
                  0 4px 10px rgba(22,141,250,0.06);
      border-radius: 16px;
    }

    .gradient-btn {
      background: linear-gradient(90deg, #168dfa, #40e0d0);
      color: white;
      font-weight: 600;
      border-radius: 14px;
      box-shadow: 4px 4px 10px rgba(0,0,0,0.06),
                  -4px -4px 10px rgba(255,255,255,0.7);
      transition: all 0.2s ease;
    }
    .gradient-btn:hover {
      transform: translateY(-2px);
      box-shadow: 6px 6px 14px rgba(22,141,250,0.12);
    }

    /* الشريط السفلي */
    nav {
      background: white;
      border-top: 1px solid #e5e7eb;
      box-shadow: 0 -2px 8px rgba(0,0,0,0.06);
      border-radius: 18px 18px 0 0;
      flex-shrink: 0;
    }

    /* الناف بار */
    .nav-item.active, .hover-blue:hover { color:#168dfa; }

    /* النافذة المنبثقة */
    .popup-overlay {
      position:fixed;top:0;left:0;width:100%;height:100%;
      background:rgba(0,0,0,0.4);display:none;
      align-items:center;justify-content:center;z-index:100;
    }
    .popup-box {
      background:#ffffff;
      padding:20px;
      border-radius:16px;
      max-width:300px;
      width:85%;
      text-align:center;
      transform:scale(0.7);
      opacity:0;
      transition:all 0.3s ease;
      box-shadow:4px 4px 10px rgba(0,0,0,0.06), -4px -4px 10px rgba(255,255,255,0.7);
    }
    .popup-box.show { transform:scale(1); opacity:1; }
  </style>
</head>

<body>
  <div class="device">
    <!-- Header -->
    <header>
      <div class="flex items-center justify-between">
        <div class="text-right">
          <div class="text-lg font-semibold">مستخدم مجهول</div>
          <span id="adhdResult" class="text-sm opacity-90"> احتمالية فرط الحركة : (هنا النتيجة)</span>
        </div>
      </div>
    </header>

    <!-- Main content (قابل للتمرير فقط هنا) -->
    <main class="space-y-4">
      <h2 class="text-right font-bold text-lg text-[#0f8073]">التقدم اليومي</h2>

      <!-- بطاقات التقدم -->
      <div class="grid grid-cols-2 gap-3">
        <div class="card p-4">
          <div class="flex items-center justify-between">
            <div id="tasksPercent" class="text-lg font-semibold text-[#168dfa]">0%</div>
            <div class="text-sm opacity-70">المهام اليومية</div>
          </div>
          <div class="mt-2 bg-white/60 h-2 rounded-full">
            <div id="tasksBar" class="h-2 rounded-full bg-[#168dfa] w-0 transition-all"></div>
          </div>
        </div>

        <div class="card p-4">
          <div class="flex items-center justify-between">
            <div id="challengesPercent" class="text-lg font-semibold text-[#0f8073]">0%</div>
            <div class="text-sm opacity-70">القرارات</div>
          </div>
          <div class="mt-2 bg-white/60 h-2 rounded-full">
            <div id="challengesBar" class="h-2 rounded-full bg-[#0f8073] w-0 transition-all"></div>
          </div>
        </div>
      </div>

      <!-- الأزرار -->
      <div class="space-y-3">
        <button onclick="window.location.href='schedule.html'" class="w-full p-4 h-16 gradient-btn">اضبط جدولك</button>
        <button id="motivate" class="w-full p-4 h-16 gradient-btn">حفزني</button>
      </div>

      <!-- جدول اليوم -->
      <div class="card p-4">
        <div class="flex items-center justify-between mb-2">
          <div class="text-lg font-bold text-[#168dfa]">جدول اليوم</div>
          <a href="schedule.html" class="text-gray-400">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 7V3m8 4V3M3 11h18M5 21h14a2 2 0 002-2V7H3v12a2 2 0 002 2z"/>
            </svg>
          </a>
        </div>
        <div id="schedulePreview" class="space-y-3 text-sm text-gray-500">
          <p>تحميل المهام...</p>
        </div>
      </div>

      <!-- قسم اتخاذ القرار -->
      <div onclick="window.location.href='decis1.html'" class="rounded-xl p-4 bg-gradient-to-r from-[#168dfa] to-[#40E0D0] text-white flex items-center justify-between shadow-md hover:scale-95 active:scale-90 transition">
        <div class="text-right">
          <div class="font-bold">اتخذ قرار!</div>
          <div class="text-sm opacity-90">متحير في قرار؟ احسمه الآن</div>
        </div>
        <div class="w-16 h-16 bg-white/20 rounded-full flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="white">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 9l4-4 4 4M8 15l4 4 4-4"/>
          </svg>
        </div>
      </div>
    </main>

    <!-- Navbar -->
    <nav>
      <div class="flex justify-around py-2 text-gray-600">
        <a href="home.html" class="flex flex-col items-center hover-blue">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 9.75L12 4l9 5.75V20a2 2 0 01-2 2H5a2 2 0 01-2-2V9.75z" />
          </svg><span class="text-xs">الرئيسية</span>
        </a>

        <a href="decis1.html" class="flex flex-col items-center hover-blue">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8 9l4-4 4 4m-8 6l4 4 4-4" />
          </svg><span class="text-xs">اتخذ قرار</span>
        </a>

        <a href="pomodoro.html" class="flex flex-col items-center hover-blue">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg><span class="text-xs">بومودورو</span>
        </a>

        <a href="schedule.html" class="flex flex-col items-center hover-blue">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3M4 11h16M4 19h16M5 7h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V9a2 2 0 012-2z" />
          </svg><span class="text-xs">الجدول</span>
        </a>

        <a href="results.html" class="flex flex-col items-center hover-blue">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg><span class="text-xs">النتيجة</span>
        </a>
      </div>
    </nav>
  </div>

  <!-- Popup -->
  <div id="popup" class="popup-overlay">
    <div class="popup-box">
      <p id="quoteText" class="mb-4 text-gray-700"></p>
      <button onclick="closePopup()" class="px-4 py-2 gradient-btn text-white">إغلاق</button>
    </div>
  </div>

  <script>
    const quotes = [
      "خذ الأمور خطوة بخطوة، ليس عليك إنجاز كل شيء دفعة واحدة.",
      "التنظيم يساعدك على السيطرة، ولو بخطوات صغيرة.",
      "الراحة جزء من الإنتاجية، لا تنس أن تعطي نفسك وقتًا.",
      "أنت قادر على الإنجاز، فقط قسم المهام واجعلها أبسط."
    ];

    const popup = document.getElementById("popup");
    const quoteText = document.getElementById("quoteText");

    document.getElementById("motivate").addEventListener("click", ()=>{
      const q = quotes[Math.floor(Math.random()*quotes.length)];
      quoteText.textContent = q;
      popup.style.display = "flex";
      setTimeout(()=> document.querySelector(".popup-box").classList.add("show"), 50);
    });

    function closePopup(){
      document.querySelector(".popup-box").classList.remove("show");
      setTimeout(()=> popup.style.display="none", 300);
    }

    // التقدم
    (function(){
      const LS_KEY = "dailySchedule_v2";
      const today = new Date().toISOString().slice(0,10);
      const preview = document.getElementById("schedulePreview");
      const percentEl = document.getElementById("tasksPercent");
      const barEl = document.getElementById("tasksBar");
      const raw = localStorage.getItem(LS_KEY);
      if(!raw){ preview.innerHTML = "<p>لا توجد مهام حتى الآن</p>"; percentEl.textContent="0%"; return; }

      const parsed = JSON.parse(raw);
      if(parsed.date !== today || !parsed.items || parsed.items.length===0){
        preview.innerHTML = "<p>لا توجد مهام حتى الآن</p>"; percentEl.textContent="0%"; return;
      }

      const tasks = parsed.items.sort((a,b)=>a.time.localeCompare(b.time)).slice(0,3);
      preview.innerHTML = tasks.map(it=>`
        <div class="flex items-center justify-between p-3 rounded-xl bg-white/60">
          <div class="text-right">
            <div class="font-semibold text-md">${it.title}</div>
            <div class="text-sm text-gray-500">${it.time}</div>
          </div>
        </div>`).join("");

      const total = parsed.items.length;
      const done = parsed.items.filter(it=>it.done).length;
      const percent = total ? Math.round((done/total)*100) : 0;
      percentEl.textContent = percent + "%";
      barEl.style.width = percent + "%";
    })();

    (function(){
      const maxChallenges = 3;
      const taken = parseInt(localStorage.getItem("takenCount")||"0");
      let percent = Math.round((taken / maxChallenges) * 100);
      if (percent > 100) percent = 100;
      document.getElementById("challengesPercent").textContent = percent + "%";
      document.getElementById("challengesBar").style.width = percent + "%";
    })();

    const whoResult = localStorage.getItem("whoResult");
    const resultEl = document.getElementById("adhdResult");
    resultEl.textContent = whoResult || "لا توجد نتيجة بعد";
  </script>
</body>
</html>
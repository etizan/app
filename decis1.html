<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>مدرب اتخاذ القرار</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
  body {
    font-family: 'Cairo', sans-serif;
    background: linear-gradient(to bottom right, #e6faff, #f6fffc, #e6f2ff);
  }

  .card-shadow {
    box-shadow: 0 10px 20px rgba(16, 24, 24, 0.06);
  }

  .btn-primary {
    background: linear-gradient(90deg, #168dfa, #2bb39b);
    color: white;
    transition: 0.3s;
  }

  .btn-primary:hover {
    background: linear-gradient(90deg, #0f8073, #168dfa);
  }

  header {
    background: white;
    border-bottom: 1px solid #dce7ea;
  }

  h2, h3, h4 {
    color: #0f8073;
  }

  .text-gray-500 {
    color: #5b676d !important;
  }

  nav a {
    color: #5b676d;
  }

  nav a:hover {
    color: #168dfa;
  }
  
  </style>
</head>
<body class="min-h-screen flex flex-col">

  <!-- Header -->
  <header class="bg-white border-b border-gray-200 flex items-center justify-between px-4 py-3">
    <button onclick="window.location.href='Home.html'" class="text-[#0f8073] font-semibold">
      رجوع →
    </button>
    <h1 class="text-lg font-bold text-gray-800 font-[Cairo]">مدرب اتخاذ القرار</h1>
    <div class="w-12"></div>
  </header>

  <!-- Content -->
  <main class="flex-1 overflow-auto pb-20">
    <div class="max-w-md mx-auto px-4">

      <div class="flex items-center justify-between mt-4 mb-3">
        <h2 class="text-lg font-semibold text-gray-700">قراراتك</h2>
        <button id="addNewBtn" class="text-[#0f8073] font-medium">+ إضافة جديد</button>
      </div>

      <div id="decisionsList" class="space-y-4"></div>

      <div class="mt-6 rounded-2xl bg-white p-4 card-shadow">
        <h3 class="text-right text-lg font-semibold mb-3">التقدم الأسبوعي</h3>
        <p id="progressText" class="text-center text-gray-400">0 قرار تم اتخاذه هذا الأسبوع</p>
      </div>

      <div class="mt-6 mb-20">
        <button id="startDecisionBtn" class="w-full py-4 rounded-2xl font-semibold shadow-lg btn-primary">
          الحياة خطوة فلا تتردد في اتخاذها!!
        </button>
      </div>
    </div>
  </main>

  <!-- Modal -->
  <div id="modal" class="hidden fixed inset-0 bg-black/30 flex items-center justify-center px-4">
    <div class="bg-white rounded-2xl w-full max-w-sm p-5 card-shadow">
      <h3 class="text-lg font-semibold mb-3 text-right">إضافة قرار جديد</h3>
      <div class="space-y-3">
        <div>
          <label class="text-sm text-gray-500">اسم القرار</label>
          <input id="decisionTitle" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200" />
        </div>
        <div>
          <label class="text-sm text-gray-500">نوع القرار</label>
          <select id="decisionType" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200">
            <option value="حياة مهنية">حياة مهنية</option>
            <option value="نمط الحياة">نمط الحياة</option>
            <option value="المالية">المالية</option>
            <option value="الطعام">الطعام</option>
          </select>
        </div>

        <!-- الإيجابيات -->
        <div id="prosSection">
          <div class="flex justify-between items-center mt-3">
            <h4 class="text-sm font-semibold text-green-700">الإيجابيات</h4>
            <button id="addProBtn" class="text-green-600 text-lg font-bold">+</button>
          </div>
          <p class="text-xs text-gray-400 mt-1">ضيف على الأقل إيجابية وحدة (حدّك 3)</p>
          <div id="prosContainer" class="space-y-2 mt-2">
            <input class="proInput w-full px-3 py-2 rounded-lg border border-green-200" placeholder="اكتب إيجابية..." />
          </div>
        </div>

        <!-- السلبيات -->
        <div id="consSection">
          <div class="flex justify-between items-center mt-3">
            <h4 class="text-sm font-semibold text-red-700">السلبيات</h4>
            <button id="addConBtn" class="text-red-600 text-lg font-bold">+</button>
          </div>
          <p class="text-xs text-gray-400 mt-1">ضيف على الأقل سلبية وحدة (حدّك 3)</p>
          <div id="consContainer" class="space-y-2 mt-2">
            <input class="conInput w-full px-3 py-2 rounded-lg border border-red-200" placeholder="اكتب سلبية..." />
          </div>
        </div>

        <div class="flex justify-between gap-2 mt-3">
          <button id="cancelBtn" class="flex-1 py-2 rounded-lg border border-gray-200">إلغاء</button>
          <button id="saveBtn" class="flex-1 py-2 rounded-lg text-white btn-primary">حفظ</button>
        </div>
      </div>
    </div>
  </div>

      <!-- Navbar -->
      <nav class="mt-6 bg-white border-t border-gray-200 shadow-md rounded-xl">
        <div class="flex justify-around py-2 text-gray-600">
          <a href="home.html" class="flex flex-col items-center hover-blue">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 9.75L12 4l9 5.75V20a2 2 0 01-2 2H5a2 2 0 01-2-2V9.75z" />
            </svg><span class="text-xs">الرئيسية</span>
          </a>

          <a href="decis1.html" class="flex flex-col items-center hover-blue">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M8 9l4-4 4 4m-8 6l4 4 4-4" />
            </svg><span class="text-xs">اتخذ قرار</span>
          </a>

          <a href="pomodoro.html" class="flex flex-col items-center hover-blue">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg><span class="text-xs">بومودورو</span>
          </a>

          <a href="schedule.html" class="flex flex-col items-center hover-blue">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3M4 11h16M4 19h16M5 7h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V9a2 2 0 012-2z" />
            </svg><span class="text-xs">الجدول</span>
          </a>

          <a href="results.html" class="flex flex-col items-center hover-blue">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg><span class="text-xs">النتيجة</span>
          </a>
        </div>
      </nav>

<script>
function setItemWithExpiry(key, value) {
  const now = new Date();
  const expiry = now.getTime() + 7*24*60*60*1000;
  const item = { value, expiry };
  localStorage.setItem(key, JSON.stringify(item));
}
function getItemWithExpiry(key) {
  const itemStr = localStorage.getItem(key);
  if (!itemStr) return null;
  const item = JSON.parse(itemStr);
  const now = new Date();
  if (now.getTime() > item.expiry) {
    localStorage.removeItem(key);
    return null;
  }
  return item.value;
}
function getDecisions(){ return getItemWithExpiry("decisions") || []; }
function setDecisions(list){ setItemWithExpiry("decisions", list); }
function getTakenCount(){ return parseInt(localStorage.getItem("takenCount")||"0"); }
function setTakenCount(n){ localStorage.setItem("takenCount", String(n)); }

const listEl=document.getElementById("decisionsList");
const modal=document.getElementById("modal");
const titleInput=document.getElementById("decisionTitle");
const typeSelect=document.getElementById("decisionType");
const saveBtn=document.getElementById("saveBtn");
const cancelBtn=document.getElementById("cancelBtn");
const addNewBtn=document.getElementById("addNewBtn");
const progressText=document.getElementById("progressText");
const prosContainer=document.getElementById("prosContainer");
const consContainer=document.getElementById("consContainer");

document.getElementById("addProBtn").onclick=()=>{
  if(prosContainer.querySelectorAll("input").length<3){
    const input=document.createElement("input");
    input.className="proInput w-full px-3 py-2 rounded-lg border border-green-200";
    input.placeholder="اكتب إيجابية...";
    prosContainer.appendChild(input);
  }else{ alert("الحد الأقصى 3 إيجابيات"); }
};

document.getElementById("addConBtn").onclick=()=>{
  if(consContainer.querySelectorAll("input").length<3){
    const input=document.createElement("input");
    input.className="conInput w-full px-3 py-2 rounded-lg border border-red-200";
    input.placeholder="اكتب سلبية...";
    consContainer.appendChild(input);
  }else{ alert("الحد الأقصى 3 سلبيات"); }
};

function renderList(){
  const data=getDecisions();
  listEl.innerHTML="";
  data.forEach((d,i)=>{
    const card=document.createElement("div");
    card.className="bg-white rounded-2xl p-4 card-shadow";
    card.innerHTML=`
      <div class="flex items-center justify-between">
        <div class="text-right">
          <h4 class="text-lg font-semibold text-gray-700">${d.title}</h4>
          <p class="text-sm text-gray-500">${d.type}</p>
        </div>
        <button class="takeBtn btn-primary px-3 py-1 rounded text-sm" data-index="${i}">اتخذه الآن</button>
      </div>`;
    listEl.appendChild(card);
  });
  progressText.textContent=`${getTakenCount()} قرار تم اتخاذه هذا الأسبوع`;
}

saveBtn.onclick=()=>{
  const title=titleInput.value.trim();
  const type=typeSelect.value;
  const pros=[...document.querySelectorAll(".proInput")].map(i=>i.value.trim()).filter(v=>v);
  const cons=[...document.querySelectorAll(".conInput")].map(i=>i.value.trim()).filter(v=>v);

  if(!title){ alert("أدخل اسم القرار"); return; }
  if(pros.length<1){ alert("ضيف على الأقل إيجابية وحدة"); return; }
  if(cons.length<1){ alert("ضيف على الأقل سلبية وحدة"); return; }

  const data=getDecisions();
  data.unshift({id:Date.now(), title, type, pros, cons});
  setDecisions(data);
  modal.classList.add("hidden");
  renderList();
};

cancelBtn.onclick=()=>modal.classList.add("hidden");
addNewBtn.onclick=()=>modal.classList.remove("hidden");

listEl.addEventListener("click",(e)=>{
  const btn=e.target.closest(".takeBtn");
  if(btn){
    const idx=btn.dataset.index;
    localStorage.setItem("currentDecision", idx);
    setTakenCount(getTakenCount()+1);
    window.location.href="decis.html";
  }
});

renderList();
</script>

</body>
</html>

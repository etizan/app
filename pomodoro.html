<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>وضع التركيز</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(to bottom right, #f9fdfd, #e6faff, #f0fcfb);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    .fade { opacity: 0; transition: opacity 0.6s ease; }
    .fade.show { opacity: 1; }

    header {
      background: #f8fffe;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      padding: 10px 14px;
      border-radius: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .neo-circle {
      background: #e6f9f7;
      border-radius: 9999px;
      box-shadow:
        inset 6px 6px 12px rgba(0,0,0,0.05),
        inset -6px -6px 12px rgba(255,255,255,0.8),
        0 0 18px rgba(22,141,250,0.06);
      transition: transform 0.2s ease;
    }

    .soft-dot {
      background: #dff7f5;
      border-radius: 9999px;
      box-shadow:
        6px 6px 12px rgba(0,0,0,0.06),
        -6px -6px 12px rgba(255,255,255,0.7);
    }

    .control-btn {
      width: 56px;
      height: 56px;
      border-radius: 9999px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #ffffff;
      box-shadow:
        6px 6px 12px rgba(0,0,0,0.06),
        -6px -6px 12px rgba(255,255,255,0.7);
      color: #168dfa;
      transition: all 0.2s ease;
    }

    .control-btn:hover {
      transform: translateY(-2px);
      box-shadow: 8px 8px 18px rgba(22,141,250,0.12);
    }

    svg { width: 22px; height: 22px; fill: #168dfa; }
    .hidden { display:none; }

    .text-main { color: #168dfa; }
    .text-emerald { color: #10b981; }
    .text-turquoise { color: #00a1ff; }

    @keyframes shake {
      0% { transform: translate(0, 0); }
      20% { transform: translate(-5px, 0); }
      40% { transform: translate(5px, 0); }
      60% { transform: translate(-5px, 0); }
      80% { transform: translate(5px, 0); }
      100% { transform: translate(0, 0); }
    }
    .shake { animation: shake 0.6s ease; }

    @media (max-width: 768px) {
      .container { width: 100%; padding: 10px; }
      .text { font-size: 14px; }
    }
    @media (min-width: 769px) and (max-width: 1024px) {
      .container { width: 90%; }
    }
  </style>
</head>

<body>
  <div class="w-full max-w-sm">

    <!-- شاشة الفوكس -->
    <div id="focusScreen" class="fade show">
      <header>
        <button onclick="window.location.href='home.html'" class="text-[#0f8073] font-semibold">
          ← رجوع
        </button>
        <h1 class="text-lg font-bold text-gray-800">مدرب اتخاذ القرار</h1>
        <div class="w-12"></div>
      </header>

      <div class="flex justify-center mb-6">
        <div id="circle" class="neo-circle w-56 h-56 flex items-center justify-center">
          <div class="text-center">
            <div id="timeDisplay" class="text-4xl text-main font-bold">٢٥:٠٠</div>
            <div class="text-sm text-gray-500">دقائق</div>
          </div>
        </div>
      </div>

      <div class="text-center mb-6">
        <div class="text-emerald font-semibold">أنت تقوم بعمل عظيم!</div>
        <div class="text-sm text-gray-500">ابقَ مركزًا، أنت قادر على ذلك</div>
      </div>

      <div class="text-center text-turquoise text-xl font-bold mb-6">تركيز</div>

      <div class="flex justify-center gap-8 mb-6">
        <button id="stopBtn" class="control-btn" title="إيقاف">
          <svg viewBox="0 0 24 24"><rect x="5" y="5" width="14" height="14" rx="2"/></svg>
        </button>
        <button id="playPauseBtn" class="control-btn" title="تشغيل/إيقاف">
          <svg id="playIcon" viewBox="0 0 24 24"><path d="M6 4L20 12L6 20V4Z"/></svg>
          <svg id="pauseIcon" class="hidden" viewBox="0 0 24 24"><rect x="6" y="4" width="4" height="16" rx="1"/><rect x="14" y="4" width="4" height="16" rx="1"/></svg>
        </button>
      </div>

      <div class="text-center text-xs text-gray-400">اضغط للتوقف مؤقتًا · اضغط باستمرار للتوقف</div>

      <div class="flex justify-end mt-8">
        <div class="soft-dot w-16 h-16"></div>
      </div>
    </div>

    <!-- شاشة البريك -->
    <div id="breakScreen" class="fade hidden">
      <header>
        <button id="backBtn" class="text-[#0f8073] font-semibold">← رجوع</button>
        <h1 class="text-lg font-bold text-gray-800">مدرب اتخاذ القرار</h1>
        <div class="w-12"></div>
      </header>

      <div class="flex justify-center mb-6">
        <div class="neo-circle w-56 h-56 flex items-center justify-center">
          <div class="text-center">
            <div id="breakDisplay" class="text-4xl text-main font-bold">٠٥:٠٠</div>
            <div class="text-sm text-gray-500">دقائق</div>
          </div>
        </div>
      </div>

      <div class="text-center mb-6">
        <div class="text-emerald font-semibold">أحسنت! حان وقت الاستراحة</div>
        <div class="text-sm text-gray-500">خذ نفسًا عميقًا ثم عد للتركيز</div>
      </div>

      <div class="text-center text-turquoise text-xl font-bold mb-6">بريك</div>
    </div>
  </div>

  <audio id="endSound" src="ding.mp3" preload="auto"></audio>

  <script>
    const focusSeconds = 25 * 60;
    const breakSeconds = 5 * 60;
    let onBreak = false, running = false, endTime=null, timer=null;
    let warnedAt5 = false;

    const timeDisplay = document.getElementById('timeDisplay');
    const breakDisplay = document.getElementById('breakDisplay');
    const focusScreen = document.getElementById('focusScreen');
    const breakScreen = document.getElementById('breakScreen');
    const playIcon = document.getElementById('playIcon');
    const pauseIcon = document.getElementById('pauseIcon');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const stopBtn = document.getElementById('stopBtn');
    const backBtn = document.getElementById('backBtn');
    const endSound = document.getElementById('endSound');
    const circle = document.getElementById('circle');

    function toArabicIndic(numStr){
      const map = {0:'٠',1:'١',2:'٢',3:'٣',4:'٤',5:'٥',6:'٦',7:'٧',8:'٨',9:'٩'};
      return String(numStr).split('').map(ch=> map[ch] ?? ch).join('');
    }
    function formatSeconds(sec){
      const mins = Math.floor(sec/60);
      const s = String(sec%60).padStart(2,'0');
      return toArabicIndic(mins+":"+s);
    }

    function showScreen(showEl, hideEl){
      hideEl.classList.remove('show');
      setTimeout(()=> {
        hideEl.classList.add('hidden');
        showEl.classList.remove('hidden');
        setTimeout(()=> showEl.classList.add('show'),50);
      },400);
    }

    function updateDisplays(rem, breaking){
      if(breaking){
        breakDisplay.textContent = formatSeconds(rem);
        showScreen(breakScreen, focusScreen);
      } else {
        timeDisplay.textContent = formatSeconds(rem);
        showScreen(focusScreen, breakScreen);
      }
    }

    function startTimer(seconds){
      endTime = Date.now() + seconds*1000;
      running = true;
      warnedAt5 = false;
      if(timer) clearInterval(timer);
      timer = setInterval(tick,1000);
    }

    function tick(){
      let rem = Math.ceil((endTime - Date.now())/1000);
      if(rem === 5 && !warnedAt5){
        warnedAt5 = true;
        if(navigator.vibrate) navigator.vibrate([200,100,200]);
        circle.classList.add("shake");
        setTimeout(()=>circle.classList.remove("shake"),700);
      }

      if(rem > 0){ updateDisplays(rem, onBreak); return; }

      clearInterval(timer); timer=null; running=false;
      try{ endSound.currentTime=0; endSound.play(); }catch(e){}
      if(navigator.vibrate) navigator.vibrate([300,150,300]);

      if(!onBreak){
        onBreak=true; startTimer(breakSeconds);
      } else {
        onBreak=false; startTimer(focusSeconds);
      }
    }

    playPauseBtn.addEventListener('click',()=>{
      if(!running){
        onBreak=false; startTimer(focusSeconds);
        playIcon.classList.add('hidden'); pauseIcon.classList.remove('hidden'); 
      } else {
        clearInterval(timer); running=false; timer=null;
        playIcon.classList.remove('hidden'); pauseIcon.classList.add('hidden');
      }
    });

    stopBtn.addEventListener('click',()=>{ 
      clearInterval(timer); running=false; onBreak=false;
      updateDisplays(focusSeconds,false);
      playIcon.classList.remove('hidden'); pauseIcon.classList.add('hidden');
    });

    backBtn.addEventListener('click',()=>{ 
      clearInterval(timer); running=false; onBreak=false;
      updateDisplays(focusSeconds,false);
      playIcon.classList.remove('hidden'); pauseIcon.classList.add('hidden');
    });

    window.onload=()=>updateDisplays(focusSeconds,false);
  </script>
</body>
</html>
